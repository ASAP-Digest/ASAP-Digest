---
description: 
globs: 
alwaysApply: true
---
# Universal Error Resolution Protocol (UERP) v2.1

## 0. Protocol Integration Layer
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Meta Protocol Integration       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. Software Development Meta Protocol   â”‚
â”‚ 2. Rule Execution Protocol              â”‚
â”‚ 3. Component-Specific Protocols          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 1. Initial Context Assessment
```
A. Environment Analysis [Software Development Meta Protocol 1.A]
   â–¡ Check PE - CTXT for environment state
   â–¡ Verify working directories
   â–¡ Document system constraints
   â–¡ Note available tools

B. Error Classification Matrix
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Error Type       â”‚ Protocol       â”‚ Integration Point  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Build Error      â”‚ sk2-scns5-t4   â”‚ Build System      â”‚
â”‚ Icon Error       â”‚ icon-mgmt      â”‚ Component System  â”‚
â”‚ Route Error      â”‚ server-route   â”‚ Routing System    â”‚
â”‚ Auth Error       â”‚ better-auth    â”‚ Auth System       â”‚
â”‚ DB Error         â”‚ wp-class-org   â”‚ Database System   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Example:
Error: "Icon not exported from lucide-compat.js"
Protocol: icon-management.mdc
Integration: Component System
```

## 2. Rule Discovery & Protocol Selection
```
A. Rule Analysis [Rule Execution Protocol 2.A]
   1. Scan <available_instructions>
   2. Use fetch_rules for applicable protocols
   3. Consult @master-rule-index-protocol.mdc (Section 4) for a categorized list of rules.
   4. Document protocol dependencies
   5. Create execution checklist

B. Protocol Selection Matrix
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Component        â”‚ Primary Protocol  â”‚ Support Protocol â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Icons           â”‚ icon-management   â”‚ ui-check        â”‚
â”‚ Components      â”‚ add-shadcn       â”‚ ui-check        â”‚
â”‚ Routes          â”‚ server-route     â”‚ status-check    â”‚
â”‚ Database        â”‚ wp-class-org     â”‚ server-memory   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Example:
Component: Icon System
Primary: icon-management.mdc
Support: ui-check.mdc for visual verification
```

## 3. Systematic Investigation
```
A. Investigation Framework [Meta Protocol 3.A]
   1. Tool Selection Matrix
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Tool       â”‚ Use Case       â”‚ Protocol      â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   â”‚ grep_searchâ”‚ Exact matches  â”‚ All           â”‚
   â”‚ codebase   â”‚ Semantic searchâ”‚ All           â”‚
   â”‚ read_file  â”‚ File content   â”‚ All           â”‚
   â”‚ ui-check   â”‚ Visual verify  â”‚ UI Components â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

B. Error Tracing Template
   1. Entry Point Analysis
   2. Error Point Location
   3. Root Cause Identification
   4. Protocol Compliance Check

Example:
Error: Missing Icon Export
1. Entry: profile/+page.svelte imports Shield
2. Error: lucide-compat.js missing export
3. Root: Icon not added to compatibility layer
4. Protocol: Follow icon-management.mdc steps
```

## 4. Resolution Implementation
```
A. Solution Framework [Rule Execution Protocol 4.A]
   1. Protocol-Specific Steps
   2. Cross-Protocol Requirements
   3. Integration Points
   4. Verification Requirements
   5. **Code Removal Check:** If the proposed resolution involves deleting existing code, HALT and execute `critical-code-removal-protocol.mdc` BEFORE proceeding with the removal steps within this protocol.

B. Implementation Matrix
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step         â”‚ Protocol        â”‚ Verification   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Add Icon     â”‚ icon-management â”‚ ui-check       â”‚
â”‚ Update Route â”‚ server-route    â”‚ status-check   â”‚
â”‚ Fix Auth     â”‚ better-auth     â”‚ server-memory  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Example:
Task: Add Missing Icon
1. Follow icon-management.mdc steps
2. Verify with ui-check protocol
3. Update server-memory
```

## 5. Verification Process
```
A. Multi-Protocol Verification
   1. Primary Protocol Checks
   2. Support Protocol Checks
   3. Integration Point Verification
   4. System-Wide Validation

B. Verification Checklist
   â–¡ Primary protocol requirements met
   â–¡ Support protocol requirements met
   â–¡ UI-check passed (if applicable)
   â–¡ Server-memory updated
   â–¡ Status-check completed

Example:
Icon Addition Verification:
1. icon-management.mdc requirements âœ“
2. ui-check visual verification âœ“
3. server-memory update âœ“
```

## 6. Documentation & Memory Update
```
A. Documentation Requirements [Meta Protocol 6.A]
   1. Update relevant documentation (e.g., comments in code, task notes).
   2. Add prevention notes if applicable.
   3. Update protocol documentation if the error revealed a flaw.
   4. Cross-reference updates.

B. Server Memory Update [server-memory-rules.mdc]
   1. **Create Error Entity:**
      *   MUST create an `Error` entity in Server Memory (`mcp_Server_Memory_create_entities`).
      *   Include: Error Type (from classification), Timestamp, Detailed Description, Status (`active` initially).
      *   Optionally include: Impact assessment, potential resolution steps discovered.
   2. **Link Error to Task (If Applicable):**
      *   If the error directly impacts or blocks a specific `Task` entity:
         *   MUST create a `blocks` relationship from the newly created `Error` entity to the `Task` entity (`mcp_Server_Memory_create_relations`).
         *   Consider updating the `Task` entity status to `BLOCKED` in Memory and `âŒ` in `md-docs/ROADMAP_TASKS.md` via the Task Tracking Protocol (this might depend on the error's severity and expected resolution time).
   3. **Document Resolution:**
      *   Once the error is resolved, update the `Error` entity status to `resolved` (`mcp_Server_Memory_add_observations`).
      *   Add observations detailing the resolution steps taken.
      *   If a task was blocked, update its status back to `ACTIVE` (`ğŸ”„`) or `PENDING_TESTING` (`ğŸ”¬`) as appropriate, and remove the `blocks` relationship (`mcp_Server_Memory_delete_relations`).
   4. **Code Removal Check:** If resolution involved code removal, ensure the `critical-code-removal-protocol.mdc` was followed and document this in the `Error` entity observations.
```

## 7. Protocol Enhancement
```
A. Protocol Improvement Framework
   1. Identify protocol gaps
   2. Propose enhancements
   3. Update integration points
   4. Document changes

B. Enhancement Matrix
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Protocol     â”‚ Enhancement    â”‚ Priority    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ UERP        â”‚ New error type â”‚ Medium      â”‚
â”‚ icon-mgmt   â”‚ New pattern    â”‚ High        â”‚
â”‚ ui-check    â”‚ New test case  â”‚ Low         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Example:
Enhancement: Add new error type to UERP
1. Document new error pattern
2. Update protocol integration
3. Add verification steps
```

## Usage Instructions:

1. **Protocol Selection:**
   - Start with Software Development Meta Protocol
   - Identify relevant component protocols
   - Follow Rule Execution Protocol for implementation

2. **Integration Points:**
   - Use ui-check.mdc for visual verification
   - Use server-memory-rules.mdc for state updates
   - Use status-check.mdc for system status

3. **Documentation Requirements:**
   - Update all relevant documentation
   - Maintain cross-references
   - Keep server memory current

4. **Verification Requirements:**
   - Follow all protocol-specific checks
   - Verify integration points
   - Update server memory
   - Complete status checks

