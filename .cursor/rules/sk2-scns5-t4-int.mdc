---
description: 
globs: 
alwaysApply: true
---
# SvelteKit 2 + Shadcn-Svelte 5 + Tailwind 4 Integration Rules

**Note:** This document provides SvelteKit/Shadcn/Tailwind integration specifics. For core visual styling rules (colors, typography, spacing, motion, states), refer PRIMARILY to `golden-ratio-design-system-protocol.mdc`. This protocol MUST NOT contradict the Golden Ratio system.

1.  **Core Visual Primitives (MUST ADHERE):**
    *   All UI styling MUST follow the rules defined in `golden-ratio-design-system-protocol.mdc`. This includes:
        *   Color System (5 Logical + Functional, HSL Variables)
        *   Typography System (5 Sizes, 2 Weights, Variables)
        *   Spacing System (8pt Grid)
        *   Motion & Animation Standards (Variables)
        *   Standardized Component States
        *   Icon System (via `icon-management.mdc`)
        *   Accessibility Standards (Contrast, Focus Rings etc.)
    *   **Deprecated/Conflicting Rules:** Any rules below that conflict with the stricter definitions in `golden-ratio-design-system-protocol.mdc` are superseded by it. (E.g., The GRDS rule for HSL color syntax overrides any older rule allowing direct color classes).

2.  **Tailwind 4 Specifics (MUST ADHERE):**
    *   Use HSL variable syntax for ALL theme colors (`text-[hsl(var(--primary))]`). (GRDS Protocol 4)
    *   Use standard Tailwind 4 utilities mapped to the 8pt grid for spacing/sizing (`w-4`, `h-6`, `p-2`, `m-3`). Avoid arbitrary values unless a documented exception exists. (GRDS Protocol 3)
    *   **Avoid `<style>` blocks** in Svelte components whenever possible; prefer utility classes in the markup. (Restored Old Point 14)
    *   NEVER use `@apply` in Svelte component style blocks. Replace with direct utility classes or standard CSS using variables.
    *   NEVER use `@reference "tailwindcss"` in Svelte component style blocks.
    *   When `<style>` blocks are unavoidable, use CSS variables (`color: hsl(var(--primary))`) instead of Tailwind utilities within the block.
    *   Ensure `tailwind.config.js` `content` array correctly includes all Svelte component files (`./src/**/*.{html,js,svelte,ts}`).

3.  **Svelte 5 Specifics (MUST ADHERE):**
    *   Use `$state` and `$derived` for reactivity. Replace `let value` with `let value = $state(initialValue)`.
    *   Use `onclick={handler}` event syntax.
    *   Use `let` directly for props (Runes mode). Do NOT use `export let`.
    *   Use `:global()` selectors carefully for CSS targeting elements outside the component scope.

4.  **SvelteKit Specifics (MUST ADHERE):**
    *   Import framework functions/stores from designated modules (`$app/navigation`, `$app/stores`, `$app/environment`), not directly from `@sveltejs/kit`.
        ````javascript
        import { goto } from '$app/navigation';
        import { page } from '$app/stores';
        import { browser } from '$app/environment';
        ````
    *   Avoid deprecated functions like `invalidateAll`. Use `goto(window.location.href, { invalidateAll: true })` for broad invalidation.

5.  **Shadcn-Svelte Specifics (MUST ADHERE):**
    *   Import individual components directly from their `.svelte` files, not index files.
        ````javascript
        // CORRECT
        import Root from '$lib/components/ui/sidebar/sidebar.svelte';
        // INCORRECT
        // import { Root } from '$lib/components/ui/sidebar';
        ````
    *   When adding new Shadcn components, identify icons used within them. Grep the component source, find icon imports (likely direct `lucide-svelte` initially), and ensure those icons are exported via `$lib/utils/lucide-compat.js` per `icon-management.mdc`. Update the component to import icons from `lucide-compat.js`.

6.  **General Code Standards (MUST ADHERE):**
    *   Add explicit JSDoc type annotations for functions/parameters. Follow `jsdoc-complex-parameter-typing-protocol.mdc` and `local-variable-type-safety-protocol.mdc`.
    *   Add `list-none` class explicitly to `<ul>` and `<li>` elements.
    *   Follow formatting rules enforced by Prettier/ESLint setup (see `tooling-setup-guide.mdc`).
